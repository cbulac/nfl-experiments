# Experiment Configuration: Safeties vs Cornerbacks Analysis
experiment:
  name: "exp_002_safeties_vs_cornerbacks"
  version: "1.0"
  date: "2025-11-05"
  author: "Your Name"
  description: "Comparative analysis of safeties and cornerbacks in interception scenarios"

# Data configuration
data:
  raw_dir: "../../data/raw/"
  train_dir: "../../data/raw/train/"
  supplementary_file: "../../data/raw/supplementary_data.csv"

  # Input/output file patterns
  input_pattern: "input_2023_w*.csv"
  output_pattern: "output_2023_w*.csv"

  # Weeks to process (null = all available)
  weeks_to_process: null  # [1, 2, 3] or null for all

  # Interim data paths
  interim_dir: "../../data/interim/"
  merged_tracking_file: "../../data/interim/merged_tracking_data.csv"
  engineered_features_file: "../../data/interim/engineered_features.csv"

  # Processed data paths
  processed_dir: "../../data/processed/"
  interceptions_file: "../../data/processed/safeties_vs_cornerbacks_interceptions.csv"
  near_misses_file: "../../data/processed/safeties_vs_cornerbacks_near_misses.csv"
  player_profiles_file: "../../data/processed/player_interception_profiles.csv"
  trajectories_file: "../../data/processed/safeties_vs_cornerbacks_trajectories.csv"

# Filtering criteria
filters:
  # Pass results to include
  pass_results_primary: ["I"]  # Interceptions only
  pass_results_secondary: ["IN", "C"]  # Incomplete and complete for near-miss analysis

  # Player positions to include
  safety_positions: ["SS", "FS", "S"]
  cornerback_positions: ["CB"]

  # Player side
  player_side: "Defense"

  # Near-miss distance threshold (yards)
  near_miss_threshold: 5.0

# Feature engineering parameters
features:
  # Spatial features
  spatial:
    calculate_distance_to_ball: true
    calculate_distance_from_los: true
    calculate_field_position: true
    hash_width: 18.5  # yards from center
    field_width: 53.33  # yards

  # Kinematic features
  kinematic:
    speed_metrics: ["mean", "max", "min", "std"]
    acceleration_metrics: ["mean", "max", "std"]
    calculate_at_throw_moment: true  # Speed/accel at last pre-throw frame

  # Directional features
  directional:
    calculate_angle_to_ball: true
    calculate_direction_alignment: true
    calculate_orientation_alignment: true
    calculate_body_control: true  # Difference between dir and o
    alignment_threshold: 30.0  # degrees for "good alignment"

  # Temporal features
  temporal:
    calculate_closing_rate: true
    min_frames_for_reaction: 3  # Minimum frames to calculate reaction time
    reaction_speed_threshold: 0.5  # yards/sec increase toward ball

  # Post-throw features
  post_throw:
    calculate_total_distance: true
    calculate_convergence_rate: true
    calculate_final_proximity: true

# Analysis parameters
analysis:
  # Statistical tests
  statistical_tests:
    alpha: 0.01  # Bonferroni corrected (0.05 / 5 hypotheses)
    alpha_uncorrected: 0.05
    confidence_level: 0.95
    power: 0.80
    alternative: "two-sided"  # Default, can be overridden per test

  # Effect size thresholds
  effect_sizes:
    small: 0.2
    medium: 0.5
    large: 0.8

  # Specific hypothesis tests
  h1_positioning:
    test_type: "t-test"  # or "welch" if unequal variances
    alternative: "greater"  # safeties > cornerbacks
    metric: "initial_dist_to_ball"

  h2_alignment:
    test_type: "t-test"
    alternative: "two-sided"
    metric: "avg_dir_alignment"
    control_variables: ["coverage_type", "pass_length"]

  h3_speed:
    test_type: "t-test"
    alternative: "two-sided"
    metric: "avg_speed"

  h4_coverage:
    test_type: "chi-square"  # or "logistic-regression"
    variables: ["position_group", "coverage_type"]

  h5_predictors:
    test_type: "logistic-regression"
    target: "made_interception"
    features: ["avg_speed", "avg_dir_alignment", "initial_dist_to_ball"]
    include_interactions: true

# Grouping and aggregation
grouping:
  position_groups:
    safeties: ["SS", "FS", "S"]
    cornerbacks: ["CB"]

  coverage_groups:
    zone: ["ZONE_COVERAGE", "COVER_2_ZONE", "COVER_3_ZONE", "COVER_4_ZONE", "COVER_6_ZONE"]
    man: ["MAN_COVERAGE"]

  pass_length_bins:
    short: [0, 10]
    medium: [10, 20]
    deep: [20, 100]

# Visualization settings
visualization:
  figure_format: "png"
  dpi: 300
  style: "whitegrid"
  color_palette: "Set2"

  # Position colors
  position_colors:
    safeties: "#2E86AB"  # Blue
    cornerbacks: "#A23B72"  # Purple

  figure_sizes:
    single_plot: [10, 6]
    comparison_plot: [12, 5]
    multi_panel: [15, 10]
    trajectory_plot: [14, 8]

# Model settings (for predictive analysis)
models:
  train_test_split: 0.80
  random_state: 42
  cross_validation_folds: 5

  logistic_regression:
    solver: "lbfgs"
    max_iter: 1000
    class_weight: "balanced"

  feature_importance:
    method: "permutation"  # or "shap"
    n_repeats: 10

# Output settings
output:
  results_dir: "results/"
  figures_dir: "results/figures/"
  log_dir: "logs/"

  save_intermediate: true
  save_trajectories: false  # Large file, set to true only if needed

  figure_names:
    position_distributions: "position_group_distributions.png"
    distance_comparison: "distance_to_ball_comparison.png"
    speed_comparison: "speed_comparison.png"
    alignment_comparison: "directional_alignment_comparison.png"
    coverage_heatmap: "coverage_by_position.png"
    trajectory_sample: "sample_trajectories.png"
    feature_importance: "feature_importance.png"
    correlation_matrix: "feature_correlations.png"

# Performance settings
performance:
  chunk_size: 100000  # Rows to process at a time for large files
  n_jobs: -1  # Parallel processing cores (-1 = all available)
  verbose: true

# Reproducibility
random_seed: 42
